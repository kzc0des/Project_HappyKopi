<div class="flex flex-col gap-4 h-full">
    <div class=" 
    bg-white shadow-sm 
    flex flex-col items-center justify-center
    px-5 py-8 gap-5 
    w-full flex-1">

        <label for="drink-image-upload" class="relative flex items-center justify-center max-w-xs px-12 py-20
                      rounded-2xl bg-[#fafafa] border-2 border-dashed border-gray-300
                      cursor-pointer transition-colors hover:bg-gray-100">

            <div id="svg-placeholder" class="
            flex flex-col items-center justify-center bg-hapikopi-yellow p-3 rounded-2xl">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-7" viewBox="0 0 24 24">
                    <path fill="#fff"
                        d="M11.5 8C14 8 16 10 16 12.5S14 17 11.5 17S7 15 7 12.5S9 8 11.5 8m0 1A3.5 3.5 0 0 0 8 12.5a3.5 3.5 0 0 0 3.5 3.5a3.5 3.5 0 0 0 3.5-3.5A3.5 3.5 0 0 0 11.5 9M5 5h2l2-2h5l2 2h2a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3m4.41-1l-2 2H5a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h13a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-2.41l-2-2z" />
                </svg>
            </div>

            <img id="image-preview" src="#" alt="Drink Preview"
                class="absolute inset-0 w-full h-full object-cover rounded-2xl hidden" />

        </label>
        <input id="drink-image-upload" type="file" class="hidden" />

        <app-itemcard class="w-full" [isEditing]="true" itemTitle="Drink Name"
            [(ngModel)]="productPayload.name"></app-itemcard>

        <app-itemcard class="w-full" [isEditing]="true" itemTitle="Description"
            [(ngModel)]="productPayload.description"></app-itemcard>

        <app-itemcard class="w-full" [isEditing]="true" itemTitle="Base Price" type="number"
            [(ngModel)]="currentVariantPrice"></app-itemcard>

        <app-dropdown-button class="w-full" itemTitle="Category" [(ngModel)]="productPayload.categoryId"
            [options]="categoryOptions">
        </app-dropdown-button>
    </div>

    <div class="bg-white flex-1 flex flex-col justify-center items-center px-5 py-8 gap-4">
        <div class="flex flex-col gap-4 w-full">

            <h3 class="text-lg font-bold text-hapikopi-dark w-full">Variants (Sizes)</h3>

            <div class="flex gap-3 flex-nowrap overflow-x-auto pb-5">
                @for(item of availableSizes; track $index){
                <app-modifier-size-card class="flex-shrink-0" [itemName]="item.name"
                    [isSelected]="selectedSizeId === item.id" [itemValue]="item.ozAmount"
                    (notifyClick)="onSizeSelect(item.id)">
                </app-modifier-size-card>
                }
            </div>
        </div>

        <div class="flex flex-col gap-5 w-full">
            <h3 class="text-lg font-semibold text-hapikopi-dark w-full">Recipe for {{ currentVariant?.size }}</h3>

            <app-add-button-card itemName="Add an Ingredient" [isDisabled]="selectedSizeId === null"
                (notifyClick)="openIngredientModal()"></app-add-button-card>

            @if(currentVariant) {
            @for(ingredient of currentVariant.recipe; track $index) {
            <div class="w-full p-3 bg-[#FFFBF2] border border-hapikopi-yellow rounded-lg flex justify-between items-center">
                <span class="font-semibold">{{ ingredient.quantityNeeded }} (units)</span>
            </div>
            }
            }

            <h3 class="text-lg font-semibold text-hapikopi-dark w-full mt-4">Add-ons for {{ currentVariant?.size }}</h3>

            <app-add-button-card itemName="Add an Add-on" [isDisabled]="selectedSizeId === null"
                (notifyClick)="openAddOnModal()"></app-add-button-card>

            @if(currentVariant) {
            @for(addOn of currentVariant.addOns; track $index) {
            <div class="w-full p-3 bg-[#FFFBF2] border border-hapikopi-yellow rounded-lg flex justify-between items-center">
                <span class="font-semibold">{{ addOn.times }}</span>
            </div>
            }
            }
        </div>

        <div class="w-full mt-6">
            <app-yellow-button class="w-full py-4" buttonTitle="Save New Drink" itemTitle="submit"
                (isClick)="submitNewProduct()">
            </app-yellow-button>
        </div>
    </div>
</div>


<app-add-ingredient-modal 
    [categoryOptions]="categoryOptions" 
    [ingredientOptions]="ingredientOptions"
    (saveIngredient)="handleSaveIngredient($event)">
</app-add-ingredient-modal>

<app-add-addon-modal [addOnOption]="addOnOption" (saveAddOn)="handleSaveAddOn($event)">
</app-add-addon-modal>